<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NEXO â€“ Galleria foto</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="logo">NEXO</div>
    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="galleria.html">Galleria</a>
      <a href="index.html#contenuti">Video</a>
    </nav>
  </header>

  <main>

    <!-- HERO GALLERIA -->
    <section class="section hero">
      <div class="section-inner">
        <span class="tagline">NEXO Â· GALLERIA FOTO</span>
        <h1>Galleria dei miei viaggi e momenti</h1>
        <p class="hero-text">
          Una raccolta di foto dei posti che ho visto, dei momenti che voglio ricordare e
          delle immagini che mi rappresentano. Sotto ogni foto puoi mettere "mi piace" e
          lasciare un commento.
        </p>
      </div>
    </section>

    <!-- GALLERIA FOTO -->
    <section class="section">
      <div class="section-inner">
        <h2>Le mie foto</h2>
        <p>
          Ogni foto ha il suo "mi piace" e il suo spazio per i commenti. Tutto viene salvato
          solo nel tuo browser, nessun dato va online.
        </p>

        <div class="photo-grid" id="photo-grid"></div>
      </div>
    </section>

    <div class="footer">
      Â© 2025 NEXO â€“ galleria foto Â· Versione di prova
    </div>

  </main>

  <!-- MODALE FOTO GRANDE -->
  <div class="photo-modal" id="photo-modal">
    <div class="photo-modal-backdrop"></div>
    <div class="photo-modal-content">
      <button class="photo-modal-close" id="photo-modal-close">âœ•</button>
      <img id="modal-image" src="" alt="">
      <p id="modal-caption"></p>
    </div>
  </div>

  <!-- SCRIPT: GESTIONE GALLERIA + LIKE + COMMENTI -->
  <script>
    (function () {
      // ELENCO DI TUTTE LE FOTO NELLA CARTELLA "foto"
      // (quelle che mi hai mandato finora)
      const photos = [
        { id: "p1", file: "0584B5A9-9E7E-4A35-9502-7287BA6746F9-10-001-min.jpeg", caption: "Foto 1" },
        { id: "p2", file: "0D325D15-68D7-4008-ADA1-CB847C27A298-L0-001-min.jpeg", caption: "Foto 2" },
       { id: "p3", file: "143C9D1D-9DBE-4D90-B013-610B34A96EE3-L0-001-min.jpeg", caption: "Foto 3" },
        { id: "p4",  file: "0D325D15-68D7-4008-ADA1-CB847C27A298-L0-001-min.jpeg", caption: "Foto 4" },
        { id: "p5",  file: "1465405923162-min.jpg", caption: "Foto 5" },
        { id: "p6",  file: "1469370405831-min.jpg", caption: "Foto 6" },
        { id: "p7",  file: "1470419988221-min.jpg", caption: "Foto 7" },
        { id: "p8",  file: "1471198944400-min.jpg", caption: "Foto 8" },
        { id: "p9",  file: "1A9C3D81-D98C-4D90-B013-610B34A96EE3-L0-001-min.jpeg", caption: "Foto 9" },
        { id: "p10", file: "20150829_092033-min.jpg", caption: "Foto 10" },
        { id: "p11", file: "20150830_133559-min.jpg", caption: "Foto 11" },
        { id: "p12", file: "20150830_142003-min.jpg", caption: "Foto 12" },
        { id: "p13", file: "20150831_103626-min.jpg", caption: "Foto 13" },
        { id: "p14", file: "20150831_114443-min.jpg", caption: "Foto 14" },
        { id: "p15", file: "20150901_071447-min.jpg", caption: "Foto 15" },
        { id: "p16", file: "20150901_181008-min.jpg", caption: "Foto 16" },
        { id: "p17", file: "20150903_064534-min.jpg", caption: "Foto 17" },
        { id: "p18", file: "20150903_093623-min.jpg", caption: "Foto 18" },
        { id: "p19", file: "20150904_080719-min.jpg", caption: "Foto 19" },
        { id: "p20", file: "2327FF89-2F1E-4066-92B4-85C3F81CD458-L0-001-min.jpeg", caption: "Foto 20" },
        { id: "p21", file: "35BAA0E6-2954-48F1-ADE3-13C74D8B535A-L0-001-min.PNG", caption: "Foto 21" },
        { id: "p22", file: "474710CD-EE94-44CC-A2D9-CD301D64E84F-L0-001-min.jpeg", caption: "Foto 22" },
        { id: "p23", file: "49300F65-A6D7-40B2-9E1B-E96B99EBFD32-L0-001-min.jpeg", caption: "Foto 23" },
        { id: "p24", file: "5F1B9905-C93A-4D79-A5AE-8B6E57430588-L0-001-min.jpeg", caption: "Foto 24" },
        { id: "p25", file: "671A1ED9-7ED1-4FE5-987C-10B83ECAFD32-L0-001-min.PNG", caption: "Foto 25" },
        { id: "p26", file: "78541821-D368-4B49-879A-6A1205C6E9BD-L0-001-min.PNG", caption: "Foto 26" },
        { id: "p27", file: "8FCF3DE8-03B1-4EF0-9707-E7E0AF711375-L0-001-min.jpeg", caption: "Foto 27" },
        { id: "p28", file: "9E36E316-BEAA-4E95-ACE6-C3A7B7145A75-L0-001-min.jpeg", caption: "Foto 28" },
        { id: "p29", file: "A3FF6DDD-4CDF-479A-863C-626C95265396-L0-001-min.PNG", caption: "Foto 29" },
        { id: "p30", file: "DSCF2491-min.JPG", caption: "Foto 30" },
        { id: "p31", file: "Foto(143)-min.jpg", caption: "Foto 31" },
        { id: "p32", file: "IMAG0070-min.jpg", caption: "Foto 32" },
        { id: "p33", file: "IMAG0072-min.jpg", caption: "Foto 33" },
        { id: "p34", file: "IMAG0077-min.jpg", caption: "Foto 34" },
        { id: "p35", file: "IMG_0092-min.JPG", caption: "Foto 35" },
        { id: "p36", file: "IMG_0115-min.JPG", caption: "Foto 36" },
        { id: "p37", file: "IMG_0370-min.JPG", caption: "Foto 37" },
        { id: "p38", file: "IMG_0478-min.JPG", caption: "Foto 38" },
        { id: "p39", file: "IMG_0482-min.JPG", caption: "Foto 39" },
        { id: "p40", file: "IMG_0540-min.JPG", caption: "Foto 40" },
        { id: "p41", file: "IMG_0550-min.JPG", caption: "Foto 41" },
        { id: "p42", file: "a151ee06-fca7-487a-ae86-47712de360b9-min.JPG", caption: "Foto 42" }
      ];

      const PHOTO_KEY = "nexo_gallery_data_v2";

      function loadStore() {
        try {
          return JSON.parse(localStorage.getItem(PHOTO_KEY) || "{}");
        } catch (e) {
          return {};
        }
      }

      function saveStore(store) {
        localStorage.setItem(PHOTO_KEY, JSON.stringify(store));
      }

      function ensurePhoto(store, id) {
        if (!store[id]) {
          store[id] = {
            likes: { heart: 0 },
            comments: []
          };
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        const grid = document.getElementById("photo-grid");

        // COSTRUISCO LE CARD DELLE FOTO
        photos.forEach(function (p) {
          const card = document.createElement("div");
          card.className = "photo-card";
          card.dataset.photo = p.id;

          card.innerHTML = `
            <div class="photo-thumb">
              <img src="foto/${p.file}" alt="${p.caption || "Foto"}" data-photo-id="${p.id}">
            </div>
            <p class="photo-caption">${p.caption || ""}</p>

            <div class="reactions photo-reactions">
              <span class="photo-react" data-photo="${p.id}" data-react="heart">
                ðŸ’™ <b class="photo-count" data-photo="${p.id}" data-react="heart">0</b>
              </span>
            </div>

            <div class="comment-area">
              <h4>Commenti</h4>
              <p class="comment-note">
                I commenti vengono salvati solo sul tuo dispositivo.
              </p>

              <textarea class="photo-comment-input" data-photo="${p.id}" placeholder="Scrivi un commento sulla foto..."></textarea>
              <button class="photo-add-comment" data-photo="${p.id}">Aggiungi commento</button>

              <ul class="photo-comment-list" data-photo="${p.id}"></ul>
            </div>
          `;

          grid.appendChild(card);
        });

        // STORE LOCALE
        const store = loadStore();

        // Inizializza like
        document.querySelectorAll(".photo-count").forEach(function (span) {
          const photoId = span.dataset.photo;
          const reaction = span.dataset.react;
          ensurePhoto(store, photoId);
          span.textContent = store[photoId].likes[reaction] || 0;
        });

        // Inizializza commenti
        document.querySelectorAll(".photo-comment-list").forEach(function (list) {
          const photoId = list.dataset.photo;
          ensurePhoto(store, photoId);
          (store[photoId].comments || []).forEach(function (text) {
            const li = document.createElement("li");
            li.textContent = text;
            list.appendChild(li);
          });
        });

        // Click "mi piace"
        document.querySelectorAll(".photo-react").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const photoId = btn.dataset.photo;
            const reaction = btn.dataset.react;
            ensurePhoto(store, photoId);
            store[photoId].likes[reaction] = (store[photoId].likes[reaction] || 0) + 1;

            const span = document.querySelector(
              '.photo-count[data-photo="' + photoId + '"][data-react="' + reaction + '"]'
            );
            if (span) span.textContent = store[photoId].likes[reaction];
            saveStore(store);
          });
        });

        // Aggiunta commenti
        document.querySelectorAll(".photo-add-comment").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const photoId = btn.dataset.photo;
            const input = document.querySelector('.photo-comment-input[data-photo="' + photoId + '"]');
            const list = document.querySelector('.photo-comment-list[data-photo="' + photoId + '"]');
            if (!input || !list) return;

            const text = (input.value || "").trim();
            if (!text) return;

            ensurePhoto(store, photoId);
            store[photoId].comments.push(text);

            const li = document.createElement("li");
            li.textContent = text;
            list.appendChild(li);

            input.value = "";
            saveStore(store);
          });
        });

        // MODALE FOTO GRANDE
        const modal = document.getElementById("photo-modal");
        const modalImg = document.getElementById("modal-image");
        const modalCaption = document.getElementById("modal-caption");
        const modalClose = document.getElementById("photo-modal-close");
        const modalBackdrop = document.querySelector(".photo-modal-backdrop");

        function openModal(src, caption) {
          modalImg.src = src;
          modalCaption.textContent = caption || "";
          modal.classList.add("open");
        }

        function closeModal() {
          modal.classList.remove("open");
          modalImg.src = "";
          modalCaption.textContent = "";
        }

        document.querySelectorAll(".photo-thumb img").forEach(function (img) {
          img.addEventListener("click", function () {
            const src = img.getAttribute("src");
            const card = img.closest(".photo-card");
            const captionEl = card ? card.querySelector(".photo-caption") : null;
            const caption = captionEl ? captionEl.textContent.trim() : "";
            openModal(src, caption);
          });
        });

        modalClose.addEventListener("click", closeModal);
        modalBackdrop.addEventListener("click", closeModal);
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") closeModal();
        });
      });
    })();
  </script>

</body>
</html>

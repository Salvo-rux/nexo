<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NEXO â€“ Galleria foto viaggi, natura e progetti</title>

  <meta name="description" content="Galleria fotografica NEXO: Sicilia e Madonie, Sirmione, CefalÃ¹, Venezia, isole greche, crociere, neve, natura, museo Ferrari, lavori elettrici e tanti momenti personali.">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="logo">NEXO</div>
    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="galleria.html" class="active">Galleria</a>
      <a href="index.html#contenuti">Video</a>
    </nav>
  </header>

  <main>

    <!-- HERO CLASSICO -->
    <section class="section hero">
      <div class="section-inner">
        <span class="tagline">NEXO Â· GALLERIA FOTO</span>
        <h1>Galleria dei miei viaggi e momenti</h1>
        <p class="hero-text">
          Sicilia e Madonie, Sirmione, CefalÃ¹, Venezia, isole greche, crociere, neve,
          natura, musei Ferrari e anche il mio lavoro nel mondo elettrico:
          una raccolta di posti vissuti e momenti importanti.
          Sotto ogni foto puoi lasciare un "mi piace" e un commento (salvati solo nel tuo dispositivo).
        </p>
      </div>
    </section>

    <!-- GALLERIA FOTO -->
    <section class="section">
      <div class="section-inner">
        <h2>Le mie foto</h2>
        <p>
          Nessun dato viene inviato online: like e commenti rimangono solo nel tuo browser.
        </p>

        <div class="photo-grid" id="photo-grid"></div>
      </div>
    </section>

    <footer class="footer">
      Â© 2025 NEXO â€“ Galleria foto Â· Versione classica
    </footer>

  </main>

  <!-- MODALE FOTO -->
  <div class="photo-modal" id="photo-modal">
    <div class="photo-modal-backdrop"></div>
    <div class="photo-modal-content">
      <button class="photo-modal-close" id="photo-modal-close">âœ•</button>
      <img id="modal-image" src="" alt="">
      <p id="modal-caption"></p>
    </div>
  </div>

  <!-- SCRIPT COMPLETO -->
  <script>
    (function () {

      const photos = [
        { id: "p4",  file: "sicilia-madonie.jpg",                 caption: "Sicilia â€“ Madonie" },
        { id: "p5",  file: "sirmione.jpg",                        caption: "Sirmione â€“ Lago di Garda" },
        { id: "p6",  file: "cefalÃ¹1.jpg",                          caption: "CefalÃ¹ â€“ costa siciliana" },
        { id: "p7",  file: "ritratto.jpg",                        caption: "Ritratto dell'autore NEXO" },
        { id: "p8",  file: "altopiano-di-asiago.jpg",             caption: "Altopiano di Asiago" },
        { id: "p9",  file: "museo-ferrari.jpg",                   caption: "Museo Ferrari â€“ auto storiche" },
        { id: "p10", file: "crociera1.jpg",                       caption: "Crociera â€“ vista dal ponte" },
        { id: "p11", file: "crociera2.jpg",                       caption: "Crociera" },
        { id: "p12", file: "crociera3.jpg",                       caption: "Crociera â€“ mare aperto" },
        { id: "p14", file: "dubrovinik.jpg",                       caption: "Dubrovnik â€“ panorama sulla cittÃ " },
        { id: "p15", file: "dubrovinik1.jpg",                      caption: "Dubrovnik â€“ mura e tetti" },
        { id: "p16", file: "isole-greche.jpg",                    caption: "Isole greche â€“ mare e isole" },
        { id: "p17", file: "isole-greche1.jpg",                   caption: "Isole greche â€“ tramonto sul mare" },
        { id: "p18", file: "spalato.jpg",                         caption: "Spalato â€“ centro storico" },
        { id: "p19", file: "venezia.jpg",                         caption: "Venezia â€“ gondole e canali" },
        { id: "p20", file: "sicilia-madonie-paese.jpg",                caption: "Sicilia â€“ strada panoramica Madonie" },
        { id: "p21", file: "villa-cordellina.jpg",                caption: "Villa Cordellina" },
        { id: "p22", file: "pizza.jpg",                           caption: "Pizza appena sfornata" },
        { id: "p23", file: "neve-a-vicenza.jpg",                  caption: "Neve a Vicenza" },
        { id: "p24", file: "museo-ferrari1.jpg",                  caption: "Museo Ferrari â€“ monoposto da corsa" },
        { id: "p25", file: "box-ferrari.png",                     caption: "Box Ferrari â€“ vettura in pit lane" },
        { id: "p26", file: "villa-cordellina2.jpg",               caption: "Villa Cordellina" },
        { id: "p27", file: "mare-sicilia1.jpg",                   caption: "Mare Sicilia â€“ costa e onde" },
        { id: "p28", file: "mare-sicilia2.jpg",                   caption: "Mare Sicilia â€“ acqua azzurra" },
        { id: "p29", file: "sicilia-madonie3.jpg",                caption: "Sicilia â€“ Madonie viste dall'alto" },
        { id: "p30", file: "casa-di-montalbano.jpg",              caption: "La casa del Commissario Montalbano" },
        { id: "p31", file: "neve-madonie1.jpg",                   caption: "Neve sulle Madonie" },
        { id: "p32", file: "santuario-madonna-dell-alto.jpg",     caption: "Santuario Madonna dell'Alto â€“ Madonie" },
        { id: "p33", file: "santuario-madonna-dell-alto2.jpg",    caption: "Santuario Madonna dell'Alto â€“ vista panoramica" },
        { id: "p34", file: "veduta-monte-alto.jpg",               caption: "Veduta dal monte â€“ orizzonte lontano" },
        { id: "p35", file: "quadro-elettrico-in-lavorazione.jpg", caption: "Quadro elettrico in lavorazione" },
        { id: "p36", file: "collegamento-interruttori.jpg",       caption: "Collegamento interruttori â€“ dettaglio impianto" },
        { id: "p37", file: "sicilia-madonie4.jpg",                caption: "Sicilia â€“ sentiero nelle Madonie" },
        { id: "p38", file: "natura1.jpg",                         caption: "Natura â€“ dettaglio vegetazione" },
        { id: "p39", file: "natura2.jpg",                         caption: "Natura â€“ foglie e verde" },
        { id: "p40", file: "neve-madonie2.jpg",                   caption: "Madonie â€“ paesaggio innevato" },
        { id: "p41", file: "neve-madonie3.jpg",                   caption: "Madonie â€“ strada nella neve" },
        { id: "p42", file: "ferrari-1000-gp.jpg",                 caption: "Ferrari 1000 GP â€“ monoposto rossa" }
      ];

      const PHOTO_KEY = "nexo_gallery_data_v2";

      function loadStore() {
        try {
          return JSON.parse(localStorage.getItem(PHOTO_KEY) || "{}");
        } catch (e) {
          return {};
        }
      }

      function saveStore(store) {
        localStorage.setItem(PHOTO_KEY, JSON.stringify(store));
      }

      function ensurePhoto(store, id) {
        if (!store[id]) {
          store[id] = {
            likes: { heart: 0 },
            comments: []
          };
        }
      }

      document.addEventListener("DOMContentLoaded", function () {

        const grid = document.getElementById("photo-grid");

        // GENERAZIONE CARD
        photos.forEach(function (p) {
          const card = document.createElement("div");
          card.className = "photo-card";
          card.dataset.photo = p.id;

          card.innerHTML = `
            <div class="photo-thumb">
              <img src="foto/${p.file}" alt="${p.caption}" data-photo-id="${p.id}">
            </div>

            <p class="photo-caption">${p.caption}</p>

            <div class="reactions photo-reactions">
              <span class="photo-react" data-photo="${p.id}" data-react="heart">
                ðŸ’™ <b class="photo-count" data-photo="${p.id}" data-react="heart">0</b>
              </span>
            </div>

            <div class="comment-area">
              <h4>Commenti</h4>
              <p class="comment-note">Salvati solo nel dispositivo.</p>

              <textarea class="photo-comment-input" data-photo="${p.id}" placeholder="Scrivi un commento..."></textarea>
              <button class="photo-add-comment" data-photo="${p.id}">Aggiungi commento</button>

              <ul class="photo-comment-list" data-photo="${p.id}"></ul>
            </div>
          `;

          grid.appendChild(card);
        });

        const store = loadStore();

        // LIKE
        document.querySelectorAll(".photo-count").forEach(function (span) {
          const id = span.dataset.photo;
          ensurePhoto(store, id);
          span.textContent = store[id].likes.heart;
        });

        document.querySelectorAll(".photo-react").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const id = btn.dataset.photo;
            ensurePhoto(store, id);
            store[id].likes.heart++;
            document.querySelector(`.photo-count[data-photo="${id}"]`).textContent = store[id].likes.heart;
            saveStore(store);
          });
        });

        // COMMENTI
        document.querySelectorAll(".photo-comment-list").forEach(function (el) {
          const id = el.dataset.photo;
          ensurePhoto(store, id);
          store[id].comments.forEach(function (t) {
            const li = document.createElement("li");
            li.textContent = t;
            el.appendChild(li);
          });
        });

        document.querySelectorAll(".photo-add-comment").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const id = btn.dataset.photo;
            const input = document.querySelector(`.photo-comment-input[data-photo="${id}"]`);
            const list = document.querySelector(`.photo-comment-list[data-photo="${id}"]`);
            const text = input.value.trim();
            if (!text) return;

            ensurePhoto(store, id);
            store[id].comments.push(text);

            const li = document.createElement("li");
            li.textContent = text;
            list.appendChild(li);

            input.value = "";
            saveStore(store);
          });
        });

        // MODALE
        const modal = document.getElementById("photo-modal");
        const modalImg = document.getElementById("modal-image");
        const modalCaption = document.getElementById("modal-caption");
        const modalClose = document.getElementById("photo-modal-close");
        const modalBackdrop = document.querySelector(".photo-modal-backdrop");

        function openModal(src, cap) {
          modalImg.src = src;
          modalCaption.textContent = cap || "";
          modal.classList.add("open");
        }

        function closeModal() {
          modal.classList.remove("open");
          modalImg.src = "";
          modalCaption.textContent = "";
        }

        document.querySelectorAll(".photo-thumb img").forEach(function (img) {
          img.addEventListener("click", function () {
            const src = img.src;
            const caption = img.closest(".photo-card").querySelector(".photo-caption").textContent;
            openModal(src, caption);
          });
        });

        modalClose.addEventListener("click", closeModal);
        modalBackdrop.addEventListener("click", closeModal);
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") closeModal();
        });
      });

    })();
  </script>

</body>
</html>

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NEXO â€“ Galleria foto</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!-- TOPBAR -->
  <header class="topbar">
    <div class="logo">NEXO</div>
    <nav class="menu">
      <a href="index.html">Home</a>
      <a href="galleria.html">Galleria</a>
      <a href="index.html#contenuti">Video</a>
    </nav>
  </header>

  <main>

    <!-- HERO GALLERIA -->
    <section class="section hero">
      <div class="section-inner">
        <span class="tagline">NEXO Â· GALLERIA FOTO</span>
        <h1>Galleria dei miei viaggi e momenti</h1>
        <p class="hero-text">
          Una raccolta di foto dei posti che ho visto, dei momenti che voglio ricordare e
          delle immagini che mi rappresentano. Sotto ogni foto puoi mettere "mi piace" e
          lasciare un commento. Cliccando sulla foto si apre in grande.
        </p>
      </div>
    </section>

    <!-- GALLERIA FOTO -->
    <section class="section">
      <div class="section-inner">
        <h2>Le mie foto</h2>
        <p>
          Puoi usare questa pagina come diario visivo: ogni foto ha il suo "mi piace" e il suo
          spazio per i commenti. I dati restano solo sul tuo dispositivo.
        </p>

        <div class="photo-grid">

          <!-- FOTO 1 -->
          <div class="photo-card" data-photo="p1">
            <div class="photo-thumb">
              <!-- CAMBIA solo il nome file se vuoi: foto1.jpg -> imola.jpg, ecc. -->
              <img src="foto/foto1.jpg" alt="Foto 1" data-photo-id="p1">
            </div>
            <p class="photo-caption">
              Foto 1 â€“ descrizione del posto o del momento.
            </p>

            <div class="reactions photo-reactions">
              <span class="photo-react" data-photo="p1" data-react="heart">
                ðŸ’™ <b class="photo-count" data-photo="p1" data-react="heart">0</b>
              </span>
            </div>

            <div class="comment-area">
              <h4>Commenti</h4>
              <p class="comment-note">
                I commenti vengono salvati solo sul tuo dispositivo.
              </p>

              <textarea class="photo-comment-input" data-photo="p1" placeholder="Scrivi un commento sulla foto..."></textarea>
              <button class="photo-add-comment" data-photo="p1">Aggiungi commento</button>

              <ul class="photo-comment-list" data-photo="p1"></ul>
            </div>
          </div>

          <!-- FOTO 2 -->
          <div class="photo-card" data-photo="p2">
            <div class="photo-thumb">
              <!-- CAMBIA solo foto2.jpg con il nome vero -->
              <img src="foto/foto2.jpg" alt="Foto 2" data-photo-id="p2">
            </div>
            <p class="photo-caption">
              Foto 2 â€“ un altro momento o panorama che ti piace.
            </p>

            <div class="reactions photo-reactions">
              <span class="photo-react" data-photo="p2" data-react="heart">
                ðŸ’™ <b class="photo-count" data-photo="p2" data-react="heart">0</b>
              </span>
            </div>

            <div class="comment-area">
              <h4>Commenti</h4>
              <p class="comment-note">
                I commenti vengono salvati solo sul tuo dispositivo.
              </p>

              <textarea class="photo-comment-input" data-photo="p2" placeholder="Scrivi un commento sulla foto..."></textarea>
              <button class="photo-add-comment" data-photo="p2">Aggiungi commento</button>

              <ul class="photo-comment-list" data-photo="p2"></ul>
            </div>
          </div>

          <!-- FOTO 3 -->
          <div class="photo-card" data-photo="p3">
            <div class="photo-thumb">
              <!-- CAMBIA solo foto3.jpg con il nome vero -->
              <img src="foto/foto3.jpg" alt="Foto 3" data-photo-id="p3">
            </div>
            <p class="photo-caption">
              Foto 3 â€“ un ricordo particolare o un luogo speciale.
            </p>

            <div class="reactions photo-reactions">
              <span class="photo-react" data-photo="p3" data-react="heart">
                ðŸ’™ <b class="photo-count" data-photo="p3" data-react="heart">0</b>
              </span>
            </div>

            <div class="comment-area">
              <h4>Commenti</h4>
              <p class="comment-note">
                I commenti vengono salvati solo sul tuo dispositivo.
              </p>

              <textarea class="photo-comment-input" data-photo="p3" placeholder="Scrivi un commento sulla foto..."></textarea>
              <button class="photo-add-comment" data-photo="p3">Aggiungi commento</button>

              <ul class="photo-comment-list" data-photo="p3"></ul>
            </div>
          </div>

          <!-- SE VUOI ALTRE FOTO:
               copia un blocco photo-card, cambia p4, p5... e il nome file in src="foto/...." -->
        </div>
      </div>
    </section>

    <div class="footer">
      Â© 2025 NEXO â€“ galleria foto Â· Versione di prova
    </div>

  </main>

  <!-- MODALE PER FOTO GRANDE -->
  <div class="photo-modal" id="photo-modal">
    <div class="photo-modal-backdrop"></div>
    <div class="photo-modal-content">
      <button class="photo-modal-close" id="photo-modal-close">âœ•</button>
      <img id="modal-image" src="" alt="">
      <p id="modal-caption"></p>
    </div>
  </div>

  <!-- SCRIPT: LIKE + COMMENTI PER FOTO + MODALE -->
  <script>
    (function () {
      const PHOTO_KEY = "nexo_gallery_data_v2";

      function loadStore() {
        try {
          return JSON.parse(localStorage.getItem(PHOTO_KEY) || "{}");
        } catch (e) {
          return {};
        }
      }

      function saveStore(store) {
        localStorage.setItem(PHOTO_KEY, JSON.stringify(store));
      }

      function ensurePhoto(store, id) {
        if (!store[id]) {
          store[id] = {
            likes: { heart: 0 },
            comments: []
          };
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        const store = loadStore();

        // Inizializza like foto
        document.querySelectorAll(".photo-count").forEach(function (span) {
          const photoId = span.dataset.photo;
          const reaction = span.dataset.react;
          ensurePhoto(store, photoId);
          span.textContent = store[photoId].likes[reaction] || 0;
        });

        // Inizializza commenti foto
        document.querySelectorAll(".photo-comment-list").forEach(function (list) {
          const photoId = list.dataset.photo;
          ensurePhoto(store, photoId);
          (store[photoId].comments || []).forEach(function (text) {
            const li = document.createElement("li");
            li.textContent = text;
            list.appendChild(li);
          });
        });

        // Gestione click sui like foto
        document.querySelectorAll(".photo-react").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const photoId = btn.dataset.photo;
            const reaction = btn.dataset.react;
            ensurePhoto(store, photoId);
            store[photoId].likes[reaction] = (store[photoId].likes[reaction] || 0) + 1;

            const span = document.querySelector(
              '.photo-count[data-photo="' + photoId + '"][data-react="' + reaction + '"]'
            );
            if (span) span.textContent = store[photoId].likes[reaction];
            saveStore(store);
          });
        });

        // Gestione commenti foto
        document.querySelectorAll(".photo-add-comment").forEach(function (btn) {
          btn.addEventListener("click", function () {
            const photoId = btn.dataset.photo;
            const input = document.querySelector('.photo-comment-input[data-photo="' + photoId + '"]');
            const list = document.querySelector('.photo-comment-list[data-photo="' + photoId + '"]');
            if (!input || !list) return;

            const text = (input.value || "").trim();
            if (!text) return;

            ensurePhoto(store, photoId);
            store[photoId].comments.push(text);

            const li = document.createElement("li");
            li.textContent = text;
            list.appendChild(li);

            input.value = "";
            saveStore(store);
          });
        });

        // MODALE FOTO GRANDE
        const modal = document.getElementById("photo-modal");
        const modalImg = document.getElementById("modal-image");
        const modalCaption = document.getElementById("modal-caption");
        const modalClose = document.getElementById("photo-modal-close");
        const modalBackdrop = document.querySelector(".photo-modal-backdrop");

        function openModal(src, caption) {
          modalImg.src = src;
          modalCaption.textContent = caption || "";
          modal.classList.add("open");
        }

        function closeModal() {
          modal.classList.remove("open");
          modalImg.src = "";
          modalCaption.textContent = "";
        }

        document.querySelectorAll(".photo-thumb img").forEach(function (img) {
          img.addEventListener("click", function () {
            const src = img.getAttribute("src");
            const card = img.closest(".photo-card");
            const captionEl = card ? card.querySelector(".photo-caption") : null;
            const caption = captionEl ? captionEl.textContent.trim() : "";
            openModal(src, caption);
          });
        });

        modalClose.addEventListener("click", closeModal);
        modalBackdrop.addEventListener("click", closeModal);
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") closeModal();
        });
      });
    })();
  </script>

</body>
</html>
